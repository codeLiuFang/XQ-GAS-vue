webpackJsonp([7],{"5B9/":function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.pstyle {\r\n    position: absolute;\r\n    /* top: 135%; */\r\n    /* left: 10%; */\r\n    margin-left: 15px;\n}\n.fbody {\r\n    position: relative;\n}\n.gtable{\r\n    width:90%; \r\n    border: 1px solid #d7dde9; \r\n    margin-left: 15px;\r\n    margin-top: 20px;\n}\n.htable{\r\n    background-color: #f6f6f6;\n}\n.el-table .info-row {\r\n      background: #c9e5f5;\n}\n.del {\r\n   float: right;\r\n   margin-right:-60px;\r\n   margin-top:-32px;\n}\n.demo-table-expand {\r\n    font-size: 0;\n}\n.demo-table-expand label {\r\n    width: 90px;\r\n    color: #99a9bf;\n}\n.demo-table-expand .el-form-item {\r\n    margin-right: 0;\r\n    margin-bottom: 0;\r\n    width: 50%;\n}\r\n",""])},"F0+f":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("xrTZ"),s=a("vLgD"),r={name:"dashboard-admin",data:function(){return{tableData:[],multipleSelection:[],name:"",select:"",pagesize:10,highlightId:-1,currentPage:1,start:1,totalCount:1e3,formLabelWidth:"120px",ruleForm:{loginId:"",password:"",companyName:"",companyAbbreviation:"",companyAddress:"",purposesOfGasUse:[],businessScope:"",placesOfGasNeeded:"",companyContacts:[{contactName:"",contactNumber:""}]},id:"",userId:"",dialogFormVisible:!1,titleMap:{addCompany:"新增企业信息",editCompany:"编辑企业信息"},dialogStatus:"",meters:""}},created:function(){this.loadData(this.currentPage,this.pagesize)},methods:{formaterContracts:function(e,t){for(var a=e[t.property],o=[],s=0;s<a.length;s++)o.push(a[s].contactNumber);return o.join("， ")},formaterGasUse:function(e,t){for(var a=e[t.property],o=[],s=0;s<a.length;s++)o.push(a[s]);return o.join(" 、")},formaterMeters:function(e,t){for(var a=e[t.property],o=[],s=0;s<a.length;s++)o.push(a[s]);return o.join(", ")},loadData:function(e,t){var a=this;s.a.get("/companies",{params:{pageNumber:e,pageSize:t}}).then(function(e){if("success"===e.data.msg){var t=e.data.data.rows;console.log(e.data.data),a.tableData=t,a.totalCount=e.data.data.total}})},addContracts:function(){this.ruleForm.companyContacts.push({contactName:"",contactNumber:""})},removeCompany:function(e){this.ruleForm.companyContacts.splice(e,1)},callOf:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},closeDialog:function(e){this.dialogFormVisible=!1,this.$refs.ruleForm.resetFields()},addCompany:function(e){var t=this;this.dialogFormVisible=!0,this.dialogStatus="addCompany",this.$nextTick(function(){t.$refs[e].resetFields(),t.ruleForm.companyContacts.length=1})},handleEdit:function(e,t){var a=this;console.log(t),this.id=t.id,this.userId=t.userId,this.dialogFormVisible=!0,this.dialogStatus="editCompany",this.titleMap.editCompany="编辑企业信息--"+t.companyName,this.$nextTick(function(){0===t.companyContacts.length&&t.companyContacts.push({contactName:"",contactNumber:""}),a.ruleForm.password=t.password,a.ruleForm.companyContacts=t.companyContacts,a.ruleForm.companyContacts=t.companyContacts,a.ruleForm.businessScope=t.businessScope,a.ruleForm.companyAddress=t.companyAddress,a.ruleForm.companyName=t.companyName,a.ruleForm.companyAbbreviation=t.companyAbbreviation,a.ruleForm.loginId=t.loginId,a.ruleForm.placesOfGasNeeded=t.placesOfGasNeeded,a.ruleForm.purposesOfGasUse=t.purposesOfGasUse,a.ruleForm.meters=t.meters})},saveCompany:function(e){var t=this;if("addCompany"===this.dialogStatus){var a=o.Base64.encode(this.ruleForm.password);this.ruleForm.password=a;var r={loginId:this.ruleForm.loginId,password:a,companyName:this.ruleForm.companyName,companyAbbreviation:this.ruleForm.companyAbbreviation,companyAddress:this.ruleForm.companyAddress,purposesOfGasUse:this.ruleForm.purposesOfGasUse.join("、"),businessScope:this.ruleForm.businessScope,placesOfGasNeeded:this.ruleForm.placesOfGasNeeded,companyContacts:this.ruleForm.companyContacts,meters:this.ruleForm.meters};s.a.post("/companies",r).then(function(e){"success"===e.data.msg?(t.dialogFormVisible=!1,t.$message({message:"添加成功",type:"success"}),t.$refs.ruleForm.resetFields(),t.loadData(t.currentPage,t.pagesize)):t.$message({message:e.data.msg,type:"error"})})}else if("editCompany"===this.dialogStatus){var n=o.Base64.encode(this.ruleForm.password);this.ruleForm.password=n;var l={loginId:this.ruleForm.loginId,password:n,companyName:this.ruleForm.companyName,companyAbbreviation:this.ruleForm.companyAbbreviation,companyAddress:this.ruleForm.companyAddress,purposesOfGasUse:this.ruleForm.purposesOfGasUse,businessScope:this.ruleForm.businessScope,meters:this.ruleForm.meters,placesOfGasNeeded:this.ruleForm.placesOfGasNeeded,companyContacts:this.ruleForm.companyContacts,id:this.id,userId:this.userId};s.a.put("/companies",l).then(function(e){"success"===e.data.msg?(t.dialogFormVisible=!1,t.$message({message:"编辑成功",type:"success"}),t.$refs.ruleForm.resetFields(),t.loadData(t.currentPage,t.pagesize)):t.$message({message:e.data.msg,type:"error"})})}},handleclick:function(e,t,a){this.highlightId=e.id},handleCurrentChange:function(e){this.currentPage=e,this.loadData(this.currentPage,this.pagesize)},handleSizeChange:function(e){this.pagesize=e,this.loadData(this.currentPage,this.pagesize)},handleSelectionChange:function(e){this.multipleSelection=e},tableRowClassName:function(e,t){if(e.row.id===this.highlightId)return"info-row"},search:function(){var e=this;if(""===this.name)this.loadData(this.currentPage,this.pagesize);else{var t="/companies/name/"+this.name;s.a.get(t,{params:{pageNumber:this.pageNumber,pageSize:this.pageSize}}).then(function(t){if("success"===t.data.msg){var a=t.data.data.rows;e.tableData=a,e.totalCount=t.data.data.total}})}},resetForm:function(){this.name=""},handleDelete:function(e,t){var a=this;this.$confirm("确定删除企业信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e="/companies/"+t.id;s.a.delete(e).then(function(e){"success"===e.data.msg&&(a.$message({type:"success",message:"删除成功!"}),a.loadData(a.currentPage,a.pagesize))})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},deletenames:function(){var e=this;0===this.multipleSelection.length?this.$message({message:"请至少选择一项企业信息",type:"info"}):this.multipleSelection.forEach(function(t){var a="/companies/"+t.id;s.a.delete(a).then(function(t){"success"===t.data.msg&&(e.$message({type:"success",message:"删除成功!"}),e.loadData(e.currentPage,e.pagesize))})})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fbody"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-input",{staticStyle:{"padding-bottom":"10px","border-radius":"10px","margin-left":"15px","margin-right":"30px"},attrs:{placeholder:"请输入内容"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-button",{staticStyle:{"background-color":"#304156",border:"none"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),a("el-button",{staticStyle:{"background-color":"#00a448",color:"white",border:"none"},attrs:{icon:"el-icon-refresh",type:"primary"},on:{click:function(t){e.resetForm()}}},[e._v("重置")]),e._v(" "),a("el-button",{staticStyle:{"background-color":"#007eff",border:"none"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.addCompany("ruleForm")}}},[e._v("添加")]),e._v(" "),a("el-button",{staticStyle:{"background-color":"#3c444e",border:"none"},attrs:{type:"success",icon:"el-icon-close"},on:{click:e.deletenames}},[e._v("批量删除")])],1),e._v(" "),e.dialogFormVisible?a("el-dialog",{attrs:{title:e.titleMap[e.dialogStatus],visible:e.dialogFormVisible,"before-close":e.closeDialog},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"企业名称",prop:"companyName"}},[a("el-input",{model:{value:e.ruleForm.companyName,callback:function(t){e.$set(e.ruleForm,"companyName",t)},expression:"ruleForm.companyName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"企业简称",prop:"companyAbbreviation"}},[a("el-input",{model:{value:e.ruleForm.companyAbbreviation,callback:function(t){e.$set(e.ruleForm,"companyAbbreviation",t)},expression:"ruleForm.companyAbbreviation"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名",prop:"loginId"}},[a("el-input",{attrs:{width:"100px"},model:{value:e.ruleForm.loginId,callback:function(t){e.$set(e.ruleForm,"loginId",t)},expression:"ruleForm.loginId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"企业地址",prop:"companyAddress"}},[a("el-input",{model:{value:e.ruleForm.companyAddress,callback:function(t){e.$set(e.ruleForm,"companyAddress",t)},expression:"ruleForm.companyAddress"}})],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},e._l(e.ruleForm.companyContacts,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:"联系人"+o,prop:"companyContacts."+o+".contactName"}},[a("el-input",{model:{value:t.contactName,callback:function(a){e.$set(t,"contactName",a)},expression:"companyContact.contactName"}})],1)})),e._v(" "),a("el-col",{attrs:{span:8}},e._l(e.ruleForm.companyContacts,function(t,o){return a("el-form-item",{key:t.key,attrs:{label:"联系方式"+o,prop:"companyContacts."+o+".contactNumber",rules:{required:!0,message:"联系方式不能为空",trigger:"blur"}}},[a("el-input",{model:{value:t.contactNumber,callback:function(a){e.$set(t,"contactNumber",a)},expression:"companyContact.contactNumber"}}),e._v(" "),a("el-button",{staticClass:"del",on:{click:function(t){t.preventDefault(),e.removeCompany(o)}}},[e._v("删除")])],1)}))],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.addContracts}},[e._v("新增联系方式")])],1),e._v(" "),a("el-form-item",{attrs:{label:"用气地点",prop:"placesOfGasNeeded"}},[a("el-input",{model:{value:e.ruleForm.placesOfGasNeeded,callback:function(t){e.$set(e.ruleForm,"placesOfGasNeeded",t)},expression:"ruleForm.placesOfGasNeeded"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用气性质",prop:"purposesOfGasUse"}},[a("el-checkbox-group",{model:{value:e.ruleForm.purposesOfGasUse,callback:function(t){e.$set(e.ruleForm,"purposesOfGasUse",t)},expression:"ruleForm.purposesOfGasUse"}},[a("el-checkbox",{attrs:{label:"采暖"}}),e._v(" "),a("el-checkbox",{attrs:{label:"生产"}}),e._v(" "),a("el-checkbox",{attrs:{label:"生活"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"经营范围",prop:"businessScope"}},[a("el-input",{model:{value:e.ruleForm.businessScope,callback:function(t){e.$set(e.ruleForm,"businessScope",t)},expression:"ruleForm.businessScope"}},[e._v("m³")])],1),e._v(" "),a("el-form-item",{attrs:{label:"燃气表编号",prop:"meters"}},[a("el-input",{model:{value:e.ruleForm.meters,callback:function(t){e.$set(e.ruleForm,"meters",t)},expression:"ruleForm.meters"}},[e._v("m³")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.callOf("ruleForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.saveCompany("ruleForm")}}},[e._v("确 定")])],1)],1):e._e()],1),e._v(" "),a("el-table",{ref:"testTable",staticClass:"gtable",attrs:{"header-cell-style":{"background-color":"#f6f6f6"},data:e.tableData,border:"","default-sort":{prop:"companyName",order:"ascending"},"row-class-name":e.tableRowClassName},on:{"selection-change":e.handleSelectionChange,"row-click":e.handleclick}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"企业名称"}},[a("span",[e._v(e._s(t.row.companyName))])]),e._v(" "),a("el-form-item",{attrs:{label:"企业地址"}},[a("span",[e._v(e._s(t.row.companyAddress))])]),e._v(" "),a("el-form-item",{attrs:{label:"用气地点"}},[a("span",[e._v(e._s(t.row.placesOfGasNeeded))])]),e._v(" "),a("el-form-item",{attrs:{label:"经营范围"}},[a("span",[e._v(e._s(t.row.businessScope))])])],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{prop:"companyName",label:"企业名称","show-overflow-tooltip":""}}),e._v(" "),a("el-table-column",{attrs:{prop:"companyContacts",formatter:e.formaterContracts,label:"联系方式",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"purposesOfGasUse",formatter:e.formaterGasUse,label:"用气性质",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"dailyPeekOfGasConsumption",label:"日高峰用气量（m³）",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"meters",formatter:e.formaterMeters,label:"燃气表编号",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit-outline"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-close"},on:{click:function(a){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pstyle",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var l=a("VU/8")(r,n,!1,function(e){a("hGx5")},null,null);t.default=l.exports},hGx5:function(e,t,a){var o=a("5B9/");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("rjj0")("bf1c17b6",o,!0)}});