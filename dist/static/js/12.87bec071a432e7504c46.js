webpackJsonp([12],{ARoL:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),s=a.n(n),o=a("NYxO"),r=a("vLgD"),i={components:{"double-line":a("Et9I").a},data:function(){return{lineChartData:{xAxisData:[],yAxisData1:{y:"预测值",value:[]},yAxisData2:{y:"实际值",value:[]}}}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;r.a.get("/predictions/latest/30").then(function(t){if("success"===t.data.msg)for(var a=t.data.data,n=a.length-1;n>=0;n--)e.lineChartData.xAxisData.push(a[n].date),e.lineChartData.yAxisData1.value.push(a[n].predictedAmount),e.lineChartData.yAxisData2.value.push(a[n].realAmount)})}}},l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("el-row",{staticStyle:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},[t("double-line",{attrs:{"chart-data":this.lineChartData}})],1)],1)},staticRenderFns:[]},c=a("VU/8")(i,l,!1,null,null,null).exports,d={data:function(){return{companyinfo:{companyName:"",companyAddress:"",placeOfGasNeeded:"",businessScope:"",purposesOfGasUse:""},tableData:[],select:"",pagesize:10,highlightId:-1,currentPage:1,start:1,totalCount:1e3,dateRange:"",companyNamesearch:"",companyId:"",selectStatus:"",radio:"1",options:[{value:"选项1",label:"已填报"},{value:"选项2",label:"未填报"}],value:""}},computed:s()({},Object(o.b)(["name"])),created:function(){this.loadData(this.currentPage,this.pagesize)},methods:{handleSizeChange:function(e){this.pagesize=e,this.loadData(this.currentPage,this.pagesize)},handleCurrentChange:function(e){this.currentPage=e,this.loadData(this.currentPage,this.pagesize)},formaterAmount:function(e,t){var a=e[t.property];return 0===a?"":a},loadData:function(e,t){var a=this;r.a.get("/companies/current",{}).then(function(n){if("success"===n.data.msg){var s=n.data.data;a.companyinfo.companyName=s.companyName,a.companyinfo.companyAddress=s.companyAddress,a.companyinfo.placeOfGasNeeded=s.placeOfGasNeeded,a.companyinfo.businessScope=s.businessScope,a.companyinfo.purposesOfGasUse=s.purposesOfGasUse.join("、");var o="/companies/name/"+s.companyName;r.a.get(o,{}).then(function(n){if("success"===n.data.msg){var s=n.data.data.rows[0].id;a.companyId=s;var o="/companies/"+s+"/gas/plans";r.a.get(o,{params:{pageNumber:e,pageSize:t}}).then(function(e){if("success"===e.data.msg){for(var t=e.data.data.rows,n=0;n<t.length;n++)t[n].isEdit=!1;a.tableData=t,a.totalCount=e.data.data.total,console.log(a.totalCount)}})}})}})},handleEdit:function(e,t){t.isEdit=!0},handleSave:function(e,t){var a=this,n="/companies/"+t.companyId+"/gas/plans",s={estimatedAmount:t.estimatedAmount,reportPerson:t.reportPerson};s.reportPerson=""===t.reportPerson?this.name:t.reportPerson,r.a.post(n,s).then(function(e){"success"===e.data.msg?(a.$message({message:"填报成功",type:"success"}),a.loadData(a.currentPage,a.pagesize)):a.$message({message:e.data.msg,type:"error"})})},searchByDate:function(){var e=this;if(""===this.dateRange)this.$message({showClose:!0,message:"请选择日期",type:"warning"});else{var t=this.dateRange,a="/gas/plans/"+t[0]+"~"+t[1];r.a.get(a,{params:{pageNumber:this.pageNumber,pageSize:this.pageSize}}).then(function(t){if("success"===t.data.msg){var a=t.data.data.rows,n=[];n=a;var s=e.companyId;e.tableData=n.filter(function(e,t,a){return e.companyId===s});for(var o=0;o<a.length;o++)a[o].isEdit=!1;e.totalCount=e.tableData.length}})}},changeStatus:function(e){var t,a=this;if(""!==(t=this.options.find(function(t){return t.value===e}))&&void 0!==t){this.selectStatus=t.label;var n="/gas/plans/status/"+this.selectStatus;r.a.get(n,{params:{pageNumber:this.pageNumber,pageSize:this.pageSize}}).then(function(e){if("success"===e.data.msg){var t=[];t=e.data.data.rows;var n=a.companyId;a.tableData=t.filter(function(e,t,a){return e.companyId===n}),console.log(a.tableData),a.totalCount=a.tableData.length}})}}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"pbody"},[a("el-card",{staticClass:"box-card box-card-style"},[a("div",{staticClass:"text item"},[a("el-form",{staticClass:"demo-form-inline",attrs:{model:e.companyinfo}},[a("el-form-item",{attrs:{label:"企业名称:"}},[a("el-form-item",[e._v(" "+e._s(e.companyinfo.companyName))])],1),e._v(" "),a("el-form-item",{attrs:{label:"企业地址:"}},[a("el-form-item",[e._v(" "+e._s(e.companyinfo.companyAddress))])],1),e._v(" "),a("el-form-item",{attrs:{label:"用气地点:"}},[a("el-form-item",[e._v(" "+e._s(e.companyinfo.placeOfGasNeeded))])],1),e._v(" "),a("el-form-item",{attrs:{label:"经营范围:"}},[a("el-form-item",[e._v(" "+e._s(e.companyinfo.businessScope))])],1),e._v(" "),a("el-form-item",{attrs:{label:"用气性质:"}},[a("el-form-item",[e._v(" "+e._s(e.companyinfo.purposesOfGasUse))])],1)],1)],1)]),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{md:6,lg:6}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"],"value-format":"yyyy-MM-dd"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1)]),e._v(" "),a("el-col",{attrs:{md:4,lg:4}},[a("el-button",{attrs:{type:"primary"},on:{click:e.searchByDate}},[e._v("查询")])],1)],1),e._v(" "),a("el-table",{ref:"testTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","default-sort":{prop:"companyName",order:"ascending"}}},[a("el-table-column",{attrs:{prop:"estimatedDate",label:"计划日期",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"estimatedAmount",label:"计划用气(方)",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("el-input",{model:{value:t.row.estimatedAmount,callback:function(a){e.$set(t.row,"estimatedAmount",a)},expression:"scope.row.estimatedAmount"}}):e._e(),e._v(" "),t.row.isEdit?e._e():a("label",[e._v(e._s(0===t.row.estimatedAmount?"":t.row.estimatedAmount))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"reportPerson",label:"填报人",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?a("el-input",{model:{value:t.row.reportPerson,callback:function(a){e.$set(t.row,"reportPerson",a)},expression:"scope.row.reportPerson"}}):e._e(),e._v(" "),t.row.isEdit?e._e():a("label",[e._v(e._s(0===t.row.reportPerson?"":t.row.reportPerson))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"reportTime",label:"填报时间","value-format":"yyyy-MM-dd",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit?e._e():a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){e.handleEdit(t.$index,t.row)}}},[e._v("填报")]),e._v(" "),""!=t.row.estimatedAmount&&t.row.isEdit?a("el-button",{attrs:{size:"small",type:"warning"},on:{click:function(a){e.handleSave(t.$index,t.row)}}},[e._v("保存")]):e._e()]}}])})],1),e._v(" "),a("el-pagination",{staticClass:"pstyle",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},staticRenderFns:[]};var p={name:"dashboard",components:{infoViewDashboard:c,gasFill:a("VU/8")(d,u,!1,function(e){a("nuUx")},null,null).exports},data:function(){return{currentRole:"gasFill"}},computed:s()({},Object(o.b)(["roles","demo","permission_routers"])),created:function(){console.log(this.roles),this.roles.includes("管理员")?(this.currentRole="infoViewDashboard",console.log(this.permission_routers[4].children[0].meta.title)):this.permission_routers[4].children[0].meta.title="气量填报"}},m={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"dashboard-container"},[t(this.currentRole,{tag:"component"})],1)},staticRenderFns:[]},f=a("VU/8")(p,m,!1,null,null,null);t.default=f.exports},LSFb:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.pstyle {\r\n    position: absolute;\r\n    /* top: 135%; */\r\n    /* left: 10%; */\r\n    margin-left: 15px;\n}\n.fbody {\r\n    position: relative;\n}\n.gtable{\r\n    width:90%; \r\n    border: 1px solid #d7dde9; \r\n    margin-left: 15px;\r\n    margin-top: 20px;\n}\n.htable{\r\n    background-color: #f6f6f6;\n}\n.el-form-item--small.el-form-item {\r\n    margin-bottom: 0px;\n}\n.el-form-item {\r\n    margin-bottom: 0px;\n}\r\n",""])},nuUx:function(e,t,a){var n=a("LSFb");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("c38f0b56",n,!0)}});